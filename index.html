<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도덕 4단원: 공정한 생활 - 동희의 오늘</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        /* 인물 소개 카드 섹션 */
        .character-intro {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            animation: slideUp 0.6s ease-out;
        }

        .intro-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .intro-title {
            font-size: 2em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .intro-subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .character-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .character-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .character-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);
        }

        .character-emoji {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .character-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .character-role {
            color: #666;
            font-size: 0.95em;
            margin-bottom: 10px;
        }

        .character-description {
            color: #555;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .story-summary {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .story-summary h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .story-summary p {
            color: #856404;
            line-height: 1.6;
        }

        /* 활동지 섹션 */
        .activity-section {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            overflow: hidden;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
        }

        .student-info {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .info-input {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 1em;
            width: 200px;
            backdrop-filter: blur(10px);
        }

        .info-input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .info-input:focus {
            outline: none;
            background: rgba(255,255,255,0.3);
            border-color: white;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .section-title {
            font-size: 1.4em;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: inline-block;
        }

        .question-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .question-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .question {
            font-size: 1.1em;
            color: #333;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 15px 0;
        }

        .concept-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .concept-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .concept-label {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .concept-label.blue { color: #3498db; }
        .concept-label.red { color: #e74c3c; }
        .concept-label.green { color: #27ae60; }
        .concept-label.orange { color: #f39c12; }

        .highlight {
            display: inline-block;
            padding: 2px 8px;
            margin: 0 2px;
            border-radius: 5px;
            font-weight: bold;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .highlight.blue {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }

        .highlight.red {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .example {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 0.95em;
            color: #856404;
        }

        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            min-height: 80px;
            transition: all 0.3s ease;
            background: white;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px dashed #e0e0e0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 30px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-save {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-clear {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-download {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(67, 233, 123, 0.3);
        }

        .btn-print {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(245, 87, 108, 0.3);
        }

        .progress-bar {
            background: #f0f0f0;
            height: 8px;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: center;
            color: #667eea;
            font-weight: bold;
            margin-top: 10px;
        }

        .saved-message {
            position: fixed;
            top: 20px;
            right: -300px;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(67, 233, 123, 0.3);
            transition: right 0.3s ease;
            font-weight: bold;
            z-index: 1000;
        }

        .saved-message.show {
            right: 20px;
        }

        @media (max-width: 768px) {
            .character-cards {
                grid-template-columns: 1fr;
            }
            .concept-grid {
                grid-template-columns: 1fr;
            }
            .btn-group {
                flex-direction: column;
            }
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 인물 소개 섹션 (별도) -->
        <div class="character-intro" id="characterIntro">
            <div class="intro-header">
                <h2 class="intro-title">📚 등장인물 소개</h2>
                <p class="intro-subtitle">동희의 오늘 - 주요 인물들</p>
            </div>

            <div class="character-cards">
                <div class="character-card">
                    <div class="character-emoji">🧑</div>
                    <div class="character-name">동희</div>
                    <div class="character-role">주인공</div>
                    <div class="character-description">
                        친구들과의 우정과 비밀 사이에서 고민하는 학생
                    </div>
                </div>

                <div class="character-card">
                    <div class="character-emoji">👧</div>
                    <div class="character-name">유미</div>
                    <div class="character-role">동희의 친구</div>
                    <div class="character-description">
                        서울에서 사온 실반지를 친구들과 나눠 낀 친구
                    </div>
                </div>

                <div class="character-card">
                    <div class="character-emoji">👦</div>
                    <div class="character-name">하연</div>
                    <div class="character-role">새로운 친구</div>
                    <div class="character-description">
                        동희가 버스에서 만난 친구
                    </div>
                </div>

                <div class="character-card">
                    <div class="character-emoji">💍</div>
                    <div class="character-name">비밀 반지</div>
                    <div class="character-role">중요한 소품</div>
                    <div class="character-description">
                        다섯 친구의 우정과 약속을 상징하는 실반지
                    </div>
                </div>
            </div>

            <div class="story-summary">
                <h3>📖 이야기 요약</h3>
                <p>
                    13살 동희는 읍내 학교로 전학 와서 유미, 선영, 홍아, 하연이와 '오총사'가 되어 실반지를 나눠 끼고 '비밀은 없기로' 약속했습니다. 
                    하지만 동희에게는 필리핀 출신 엄마에 대한 비밀이 있었고, 가장 친한 하연이에게만 이를 털어놓았습니다.
                    그런데 하연이가 실수로 이 비밀을 다른 친구들에게 알려버리고, 친구들은 동희가 약속을 어겼다며 따돌리기 시작합니다.
                    영어 말하기 대회가 있는 하루 동안 벌어지는 갈등과 화해를 통해, 동희는 진정한 우정과 차이를 인정하는 공정함에 대해 깨닫게 됩니다.
                </p>
            </div>
        </div>

        <!-- 활동지 섹션 -->
        <div class="activity-section" id="captureArea">
            <div class="header">
                <h1>✍️ 도덕 4단원: 공정한 생활 활동지</h1>
                <p>동희의 오늘을 읽고 생각해보기</p>
                <div class="student-info">
                    <input type="text" class="info-input" id="studentName" placeholder="이름">
                    <input type="text" class="info-input" id="studentClass" placeholder="학년 반 번호">
                </div>
            </div>

            <div class="content">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
                <div class="progress-text" id="progressText">진행률: 0%</div>

                <!-- 활동 1: 개념 이해하기 -->
                <div class="section">
                    <h2 class="section-title">📝 활동 1: 개념 이해하기</h2>
                    
                    <div class="question-box">
                        <div class="question">
                            내가 생각하는 의미를 각각 적어 봅시다.
                        </div>
                        
                        <div class="concept-grid">
                            <div class="concept-item">
                                <div class="concept-label blue">
                                    <span>🔵</span> 다름
                                </div>
                                <textarea id="answer1" placeholder="'다름'의 의미를 적어보세요..." oninput="updateProgress()"></textarea>
                            </div>
                            
                            <div class="concept-item">
                                <div class="concept-label red">
                                    <span>🔴</span> 틀림
                                </div>
                                <textarea id="answer2" placeholder="'틀림'의 의미를 적어보세요..." oninput="updateProgress()"></textarea>
                            </div>
                            
                            <div class="concept-item">
                                <div class="concept-label green">
                                    <span>🟢</span> 차이
                                </div>
                                <textarea id="answer3" placeholder="'차이'의 의미를 적어보세요..." oninput="updateProgress()"></textarea>
                            </div>
                            
                            <div class="concept-item">
                                <div class="concept-label orange">
                                    <span>🟠</span> 차별
                                </div>
                                <textarea id="answer4" placeholder="'차별'의 의미를 적어보세요..." oninput="updateProgress()"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="question-box">
                        <div class="question">
                            만약 피부색, 언어, 인종의 <span class="highlight blue">'차이'</span>로 
                            <span class="highlight red">'차별'</span>을 한다면 어떤 결과가 생길까요?
                        </div>
                        <div class="example">
                            💡 예시: 한국말이 서툴다고 놀리면 상처받고 어울리지 않게 될 수 있어요
                        </div>
                        <textarea id="answer5" placeholder="여기에 생각을 적어보세요..." oninput="updateProgress()"></textarea>
                    </div>
                </div>

                <!-- 활동 2: 우리 주변의 공정함 -->
                <div class="section">
                    <h2 class="section-title">⚖️ 활동 2: 우리 주변의 공정함</h2>
                    
                    <div class="question-box">
                        <div class="question">
                            우리 주변에서 일어나고 있는 공정하지 못한 일은 무엇이 있나요?
                        </div>
                        <div class="example">
                            💡 예시: 피구를 할 때 친한 친구와만 같은 편을 하려고 했던 일
                        </div>
                        <textarea id="answer6" placeholder="첫 번째 예시..." oninput="updateProgress()"></textarea>
                        <textarea id="answer7" placeholder="두 번째 예시..." oninput="updateProgress()"></textarea>
                    </div>

                    <div class="question-box">
                        <div class="question">
                            내가 생각하는 공정함이란 무엇인지 이야기해 봅시다.
                        </div>
                        <div class="example">
                            💡 예시: 체육을 못하는 친구와 함께 같은 편이 되어 주는 것
                        </div>
                        <textarea id="answer8" placeholder="나의 생각을 자유롭게 적어보세요..." oninput="updateProgress()"></textarea>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-clear" onclick="clearAll()">🔄 다시 작성</button>
                    <button class="btn btn-save" onclick="saveAnswers()">💾 저장하기</button>
                    <button class="btn btn-download" onclick="downloadAsImage()">📸 이미지 다운로드</button>
                    <button class="btn btn-print" onclick="window.print()">🖨️ 인쇄하기</button>
                </div>
            </div>
        </div>
    </div>

    <div class="saved-message" id="savedMessage">
        ✅ 답변이 저장되었습니다!
    </div>

    <script>
        // 페이지 로드 시 저장된 데이터 불러오기
        window.onload = function() {
            // 학생 정보 불러오기
            const savedName = localStorage.getItem('student_name');
            const savedClass = localStorage.getItem('student_class');
            if (savedName) document.getElementById('studentName').value = savedName;
            if (savedClass) document.getElementById('studentClass').value = savedClass;

            // 답변 필드
            for (let i = 1; i <= 8; i++) {
                const saved = localStorage.getItem(`moral_answer${i}`);
                if (saved) {
                    document.getElementById(`answer${i}`).value = saved;
                }
            }
            updateProgress();
        };

        // 답변 저장하기
        function saveAnswers() {
            // 학생 정보 저장
            localStorage.setItem('student_name', document.getElementById('studentName').value);
            localStorage.setItem('student_class', document.getElementById('studentClass').value);

            // 답변 필드 저장
            for (let i = 1; i <= 8; i++) {
                const answer = document.getElementById(`answer${i}`).value;
                localStorage.setItem(`moral_answer${i}`, answer);
            }
            
            // 저장 메시지 표시
            const message = document.getElementById('savedMessage');
            message.classList.add('show');
            setTimeout(() => {
                message.classList.remove('show');
            }, 3000);
        }

        // 모든 답변 지우기
        function clearAll() {
            if (confirm('모든 답변을 지우시겠습니까?')) {
                for (let i = 1; i <= 8; i++) {
                    document.getElementById(`answer${i}`).value = '';
                    localStorage.removeItem(`moral_answer${i}`);
                }
                updateProgress();
            }
        }

        // 진행률 업데이트
        function updateProgress() {
            let filled = 0;
            let total = 8;
            
            for (let i = 1; i <= 8; i++) {
                if (document.getElementById(`answer${i}`).value.trim() !== '') {
                    filled++;
                }
            }
            
            const progress = Math.round((filled / total) * 100);
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `진행률: ${progress}% (${filled}/${total})`;
        }

        // 이미지로 다운로드
        function downloadAsImage() {
            // 인물 소개 섹션 숨기기
            document.getElementById('characterIntro').style.display = 'none';
            
            html2canvas(document.getElementById('captureArea'), {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const link = document.createElement('a');
                const date = new Date().toLocaleDateString('ko-KR');
                const name = document.getElementById('studentName').value || '미입력';
                link.download = `도덕활동지_${name}_${date.replace(/\./g, '-')}.png`;
                link.href = canvas.toDataURL();
                link.click();
                
                // 인물 소개 섹션 다시 보이기
                document.getElementById('characterIntro').style.display = 'block';
                
                // 성공 메시지
                const message = document.getElementById('savedMessage');
                message.textContent = '📸 이미지가 다운로드되었습니다!';
                message.classList.add('show');
                setTimeout(() => {
                    message.classList.remove('show');
                    message.textContent = '✅ 답변이 저장되었습니다!';
                }, 3000);
            });
        }

        // 자동 저장 (30초마다)
        setInterval(saveAnswers, 30000);
    </script>
</body>
</html>